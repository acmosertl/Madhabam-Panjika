<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ü™î ‡¶Æ‡¶æ‡¶ß‡¶¨‡¶Æ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ vC4</title>
<style>
:root{
  --bg:#fff4e3;--card:#fff8ee;--pink:#f6a9d6;
  --red:#c62828;--gold:#ffd740;--label:#4527a0;
  --glow:#52ff8f;--shadow:0 6px 16px rgba(0,0,0,.12);
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);font-family:"Noto Sans Bengali",system-ui,sans-serif;color:#1a1a1a}
.wrap{max-width:860px;margin:14px auto;padding:8px}
.card{background:var(--card);border-radius:20px;padding:14px;margin:10px;box-shadow:var(--shadow)}
.title{text-align:center;font-weight:900;font-size:22px;margin-bottom:8px}
.grid{display:grid;gap:10px}
.grid-2{grid-template-columns:1fr 1fr}

/* Pills */
.pill{background:var(--pink);border-radius:14px;padding:12px}
.label{color:var(--label);font-weight:900;margin-bottom:4px}
.value{font-weight:900;font-size:26px;line-height:1.18}
.sub{font-size:16px;margin-top:4px}
.sub b{font-weight:900}

/* Ekadashi */
.eka{background:var(--red);color:#fff;text-align:center}
.eka-name{color:var(--gold);font-size:40px;font-weight:900;letter-spacing:.2px;
  text-shadow:0 0 14px #ffeb3b,0 0 28px #ffd54f}
.eka-meta{font-size:20px;font-weight:800;margin-top:4px}

/* Upcoming (bigger, full width) */
.up{background:#ffe895;text-align:center;color:#b71c1c}
.up .name{font-weight:900;font-size:30px}
.up .meta{font-weight:900;font-size:20px;margin-top:4px}

/* Tide blocks: exactly two full-width cards */
.tideBlock{background:linear-gradient(180deg,#183a8a,#0b2257);color:#fff;border-radius:18px;padding:12px;margin:10px}
.tbTitle{text-align:center;font-size:20px;font-weight:900;margin-bottom:8px}
.tideGrid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.tCell{background:rgba(255,255,255,.1);border-radius:12px;padding:10px;text-align:center}
.tLab{color:#fff;font-weight:900;margin-bottom:2px}
.tVal{font-weight:900;font-size:22px;color:var(--glow);text-shadow:0 0 10px rgba(82,255,143,.55)}
.kolkata{color:#ffd54f;text-align:center;font-weight:900;margin-top:8px}
.kTime{color:var(--glow);font-weight:900;font-size:18px}

/* AM/PM smaller */
.time .ampm{font-size:.82em;margin-left:4px}

/* Popup calendar trigger + modal */
.trigger{background:#FFF8E1;color:#7B1FA2;text-align:center;border-radius:12px;padding:12px;font-weight:900;cursor:pointer}
.trigger:hover{filter:brightness(1.05)}
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.45);z-index:50}
.modal .box{background:#fff;border-radius:16px;max-width:900px;width:94%;padding:14px}
.modal .head{display:flex;justify-content:space-between;align-items:center;font-weight:900;margin-bottom:8px}
.modal .body{height:60vh;border:1px solid #eee;border-radius:10px;overflow:auto;padding:8px}
.close{cursor:pointer;font-weight:900}
</style>
</head>
<body>
<div class="wrap">

  <!-- ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ -->
  <section class="card">
    <div class="title">ü™î ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ</div>
    <div class="grid">
      <div class="pill">
        <div class="label">‡¶§‡¶ø‡¶•‡¶ø</div>
        <div class="value" id="tithi">‚Äî</div>
        <div class="sub"><b>‡¶∂‡ßá‡¶∑:</b> <span id="tithiEnds">‚Äî</span> &nbsp; <b>‚Ä¢</b> &nbsp; <b>‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ:</b> <span id="tithiNext">‚Äî</span></div>
      </div>
      <div class="pill">
        <div class="label">‡¶™‡¶ï‡ßç‡¶∑</div>
        <div class="value" id="paksha">‚Äî</div>
      </div>
      <div class="pill">
        <div class="label">‡¶®‡¶ï‡ßç‡¶∑‡¶§‡ßç‡¶∞</div>
        <div class="value" id="nakshatra">‚Äî</div>
        <div class="sub"><b>‡¶∂‡ßá‡¶∑:</b> <span id="nEnd">‚Äî</span> &nbsp; <b>‚Ä¢</b> &nbsp; <b>‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ:</b> <span id="nNext">‚Äî</span></div>
      </div>
    </div>
    <div class="grid grid-2" style="margin-top:10px">
      <div class="pill"><div class="label">‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡ßã‡¶¶‡¶Ø‡¶º</div><div class="value time" id="sunrise">‚Äî</div></div>
      <div class="pill"><div class="label">‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡¶æ‡¶∏‡ßç‡¶§</div><div class="value time" id="sunset">‚Äî</div></div>
      <div class="pill"><div class="label">‡¶ö‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßã‡¶¶‡¶Ø‡¶º</div><div class="value time" id="moonrise">‚Äî</div></div>
      <div class="pill"><div class="label">‡¶ö‡¶®‡ßç‡¶¶‡ßç‡¶∞‡¶æ‡¶∏‡ßç‡¶§</div><div class="value time" id="moonset">‚Äî</div></div>
    </div>
  </section>

  <!-- Popup Calendar trigger -->
  <section class="card trigger" id="openCal">üìÖ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</section>

  <!-- ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ -->
  <section class="card eka">
    <div class="title">üåº ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ</div>
    <div class="eka-name" id="ekaName">‚Äî</div>
    <div class="eka-meta" id="ekaDate">‚Äî</div>
    <div class="eka-meta" id="ekaLeft">‚Äî ‡¶¶‡¶ø‡¶® ‡¶¨‡¶æ‡¶ï‡¶ø</div>
    <div class="eka-meta" id="ekaParana">‚Äî</div>
  </section>

  <!-- ‡¶Ü‡¶∏‡¶®‡ßç‡¶® ‡¶â‡ßé‡¶∏‡¶¨ -->
  <section class="card up">
    <div class="name" id="festName">üì£ ‚Äî</div>
    <div class="meta" id="festDate">‚Äî</div>
  </section>

  <!-- Tide ‚Üí ‡¶¶‡ßÅ‡¶ü‡¶ø ‡¶´‡ßÅ‡¶≤-‡¶â‡¶á‡¶°‡¶• ‡¶ï‡¶æ‡¶∞‡ßç‡¶° -->
  <section class="tideBlock">
    <div class="tbTitle">üåä ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ú‡ßã‡¶Ø‡¶º‡¶æ‡¶∞</div>
    <div class="tideGrid">
      <div class="tCell"><div class="tLab">‡¶â‡¶ö‡ßç‡¶ö ‡¶ú‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡ßß</div><div class="tVal time" id="tj1">‚Äî</div></div>
      <div class="tCell"><div class="tLab">‡¶â‡¶ö‡ßç‡¶ö ‡¶ú‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡ß®</div><div class="tVal time" id="tj2">‚Äî</div></div>
    </div>
    <div class="kolkata">üïí ‡¶ï‡¶≤‡¶ï‡¶æ‡¶§‡¶æ</div>
    <div class="kTime" id="kTimeJ">‚Äî</div>
  </section>

  <section class="tideBlock">
    <div class="tbTitle">üåä ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶≠‡¶æ‡¶ü‡¶æ</div>
    <div class="tideGrid">
      <div class="tCell"><div class="tLab">‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶≠‡¶æ‡¶ü‡¶æ ‡ßß</div><div class="tVal time" id="tv1">‚Äî</div></div>
      <div class="tCell"><div class="tLab">‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶≠‡¶æ‡¶ü‡¶æ ‡ß®</div><div class="tVal time" id="tv2">‚Äî</div></div>
    </div>
    <div class="kolkata">üïí ‡¶ï‡¶≤‡¶ï‡¶æ‡¶§‡¶æ</div>
    <div class="kTime" id="kTimeV">‚Äî</div>
  </section>

</div>

<!-- Popup Calendar Modal -->
<div class="modal" id="calModal">
  <div class="box">
    <div class="head">
      <div>üìÖ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞</div>
      <div class="close" id="closeCal">‚úñ</div>
    </div>
    <div class="body" id="calBody">
      <!-- ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶™‡¶∞‡ßá full calendar embed/engine ‡¶¨‡¶∏‡¶¨‡ßá -->
      <p>‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶™‡ßç‡¶≤‡ßá‡¶∏‡¶π‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞‚Äî‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶™‡¶™-‡¶Ü‡¶™ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶π‡¶¨‡ßá‡•§</p>
    </div>
  </div>
</div>

<!-- ‚¨á ‡¶è‡¶á ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶¨‡ßç‡¶≤‡¶ï‡¶ü‡¶æ ‡¶™‡ßÅ‡¶∞‡¶®‡ßã index.html-‡¶è‡¶∞ ‡¶∂‡ßá‡¶∑‡ßá </body> ‡¶ü‡ßç‡¶Ø‡¶æ‡¶ó‡ßá‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶¨‡¶∏‡¶æ‡¶ì -->
<script>
(async function(){
  try{
    const res = await fetch('/data/panchika.json?'+Date.now());
    const d = await res.json();

    // Panchika
    set('tithi', d.tithi);
    set('nakshatra', d.nakshatra);
    set('sunrise', d.sunrise);
    set('sunset', d.sunset);
    set('moonrise', d.moonrise);
    set('moonset', d.moonset);

    // Ekadashi
    if (d.ekadashi){
      set('ekaName', d.ekadashi.name);
      set('ekaMeta', `${formatDate(d.ekadashi.date)} ‚Ä¢ ${d.ekadashi.days_left} ‡¶¶‡¶ø‡¶® ‡¶¨‡¶æ‡¶ï‡¶ø`);
    }

    // Festival
    if (d.events && d.events.length){
      set('festName', d.events[0].name);
      set('festMeta', `${formatDate(d.events[0].date)} ‚Ä¢ ${d.events[0].days_left} ‡¶¶‡¶ø‡¶® ‡¶™‡¶∞‡ßá`);
    }

    // Tide
    const T = d.tide || [];
    set('th1', T[0]?.time || '‚Äî');
    set('th2', T[1]?.time || '‚Äî');
    set('tl1', T[2]?.time || '‚Äî');
    set('tl2', T[3]?.time || '‚Äî');
  }catch(e){console.error(e);}
  
  function set(id,v){ const el=document.getElementById(id); if(el) el.textContent=v??'‚Äî'; }
  function formatDate(str){
    try{
      const d=new Date(str+'T00:00:00');
      return new Intl.DateTimeFormat('bn-BD',{day:'2-digit',month:'short',year:'numeric'}).format(d);
    }catch{return str;}
  }
})();
</script>
<!-- ‚¨Ü ‡¶è‡¶ñ‡¶æ‡¶®‡ßá‡¶á ‡¶∂‡ßá‡¶∑ -->

  <script>
// üîÑ Auto-refresh Panchika every 3 hours
async function autoRefreshPanchika() {
  try {
    const res = await fetch('/api/update');
    const data = await res.json();

    if (data.ok && data.data) {
      const p = data.data;
      document.querySelector('.tithi').textContent = p.tithi || '-';
      document.querySelector('.nakshatra').textContent = p.nakshatra || '-';
      document.querySelector('.sunrise').textContent = p.sunrise;
      document.querySelector('.sunset').textContent = p.sunset;
      document.querySelector('.moonrise').textContent = p.moonrise;
      document.querySelector('.moonset').textContent = p.moonset;

      // ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ ‡¶§‡¶•‡ßç‡¶Ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü
      document.querySelector('.ekadashi-name').textContent = p.ekadashi.name;
      document.querySelector('.ekadashi-date').textContent = p.ekadashi.date;
      document.querySelector('.ekadashi-days').textContent = `${p.ekadashi.days_left} ‡¶¶‡¶ø‡¶® ‡¶¨‡¶æ‡¶ï‡¶ø`;

      // ‡¶∏‡¶∞‡ßç‡¶¨‡¶∂‡ßá‡¶∑ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶∏‡¶Æ‡¶Ø‡¶º
      document.querySelector('.last-updated').textContent = 
        `‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶π‡ßü‡ßá‡¶õ‡ßá: ${new Date(p.updated).toLocaleTimeString('bn-BD')}`;
    }
  } catch (err) {
    console.error('Panchika update failed:', err);
  }
}

// ‡¶™‡ßç‡¶∞‡¶•‡¶Æ‡¶¨‡¶æ‡¶∞ ‡¶≤‡ßã‡¶°‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶ï‡¶≤ ‡¶ï‡¶∞‡ßã
autoRefreshPanchika();

// ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ß© ‡¶ò‡¶®‡ßç‡¶ü‡¶æ ‡¶Ö‡¶®‡ßç‡¶§‡¶∞ ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßã (3 √ó 60 √ó 60 √ó 1000 ms)
setInterval(autoRefreshPanchika, 10800000);
  </script>
  
</body>
</html>

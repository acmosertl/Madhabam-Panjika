<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>‡¶Æ‡¶æ‡¶ß‡¶¨‡¶Æ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ ‚Äî Panel One</title>
<style>
  :root{
    --bg:#fff1d6; --radius:16px; --shadow:0 2px 10px rgba(0,0,0,.14);
    --yellow-deep:#ffd740; --yellow-soft:#ffe97a; /* label contrast */
    --pink:#ff9ee7; --red:#d32f2f; --fest:#fff59d; --festText:#b71c1c;
    --blue1:#1e3a8a; --blue2:#0d1b4c;
  }
  body{margin:0;background:var(--bg);font-family:"Noto Sans Bengali",sans-serif;padding:16px}
  .panel{background:#fff;border-radius:var(--radius);box-shadow:var(--shadow);padding:12px 14px;margin:0 auto 14px;max-width:720px}
  .title{font-weight:800;text-align:center;margin:.2rem 0 .6rem}

  /* ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ */
  .panchika{background:linear-gradient(to bottom,var(--yellow-soft),var(--yellow-deep))}
  .panchika .title{color:#5c2f00}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .cell{background:var(--pink);border-radius:12px;padding:8px}
  .label{color:#1b1b1b;background:linear-gradient(to right,#fffad1,#ffe97a);display:inline-block;padding:2px 8px;border-radius:6px;font-weight:800}
  .value{display:block;margin-top:6px;font-weight:800;color:#000}

  /* ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ (trigger) */
  .trigger{background:#FFF8E1;color:#7B1FA2;text-align:center;border-radius:12px;padding:12px;font-weight:800;box-shadow:0 2px 6px rgba(0,0,0,.2);cursor:pointer}
  .trigger:hover{filter:brightness(1.05)}

  /* ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ */
  .eka{background:var(--red);color:#fff;text-align:center}
  .eka .title{margin:.3rem 0 .3rem}
  .eka .name{font-size:1.6rem;font-weight:900;text-shadow:0 0 10px rgba(255,255,255,.5)}
  .eka .meta{opacity:.95}

  /* ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü */
  .fest{background:var(--fest);color:var(--festText);text-align:center}
  .fest .name{font-weight:900;font-size:1.2rem}
  .fest .meta{opacity:.9}

  /* ‡¶ú‡ßã‡¶Ø‡¶º‡¶æ‡¶∞-‡¶≠‡¶æ‡¶ü‡¶æ */
  .tide{background:linear-gradient(to bottom,var(--blue1),var(--blue2));color:#fff}
  .tide .title{color:#fff}
  .tide-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
  .tide-cell{background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.28);border-radius:12px;padding:8px}
  .tide-row{display:flex;justify-content:space-between;gap:8px}
  .tide-label{font-weight:800;opacity:.95}
  .tide-val{font-weight:800}
  .icon{font-size:1.3em;text-shadow:0 0 9px rgba(255,255,255,.85)}
</style>
</head>
<body>
  <!-- 1) ü™î ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ -->
  <section class="panel panchika">
    <div class="title">ü™î ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ</div>
    <div class="grid">
      <div class="cell"><span class="label">‡¶§‡¶ø‡¶•‡¶ø</span><span id="tithi" class="value">‚Äî</span></div>
      <div class="cell"><span class="label">‡¶®‡¶ï‡ßç‡¶∑‡¶§‡ßç‡¶∞</span><span id="nakshatra" class="value">‚Äî</span></div>
      <div class="cell"><span class="label">‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡ßã‡¶¶‡¶Ø‡¶º</span><span id="sunrise" class="value">‚Äî</span></div>
      <div class="cell"><span class="label">‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø‡¶æ‡¶∏‡ßç‡¶§</span><span id="sunset" class="value">‚Äî</span></div>
      <div class="cell"><span class="label">‡¶ö‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßã‡¶¶‡¶Ø‡¶º</span><span id="moonrise" class="value">‚Äî</span></div>
      <div class="cell"><span class="label">‡¶ö‡¶®‡ßç‡¶¶‡ßç‡¶∞‡¶æ‡¶∏‡ßç‡¶§</span><span id="moonset" class="value">‚Äî</span></div>
    </div>
    <div style="font-size:.9em;margin-top:8px">‡¶∏‡ßÇ‡¶∞‡ßç‡¶Ø/‡¶ö‡¶®‡ßç‡¶¶‡ßç‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡ß© ‡¶ò‡¶£‡ßç‡¶ü‡¶æ ‡¶Ö‡¶®‡ßç‡¶§‡¶∞ ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂</div>
  </section>

  <!-- 2) üìÖ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ (Popup Trigger just under Panchika) -->
  <section class="panel trigger" id="calendarTrigger" data-popup="madhabam-fullcalendar" data-href="/calendar">
    üìÖ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶π‡¶ø‡¶®‡ßç‡¶¶‡ßÅ ‡¶™‡¶û‡ßç‡¶ú‡¶ø‡¶ï‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®
  </section>

  <!-- 3) üïâÔ∏è ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ -->
  <section class="panel eka">
    <div class="title">üïâÔ∏è ‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶è‡¶ï‡¶æ‡¶¶‡¶∂‡ßÄ</div>
    <div id="ekaName" class="name">‚Äî</div>
    <div id="ekaMeta" class="meta">‚Äî</div>
  </section>

  <!-- 4) üì£ ‡¶Ü‡¶∏‡¶®‡ßç‡¶® ‡¶â‡ßé‡¶∏‡¶¨ -->
  <section class="panel fest">
    <div class="icon">üì£</div>
    <div id="festName" class="name">‡¶ó‡ßÄ‡¶§‡¶æ ‡¶ú‡¶Ø‡¶º‡¶®‡ßç‡¶§‡ßÄ</div>
    <div id="festMeta" class="meta">‚Äî</div>
  </section>

  <!-- 5) üåä ‡¶ú‡ßã‡¶Ø‡¶º‡¶æ‡¶∞-‡¶≠‡¶æ‡¶ü‡¶æ -->
  <section class="panel tide">
    <div class="title">üåä ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ú‡ßã‡¶Ø‡¶º‡¶æ‡¶∞-‡¶≠‡¶æ‡¶ü‡¶æ</div>
    <div class="tide-grid">
      <div class="tide-cell"><div class="tide-row"><span class="tide-label">‡¶â‡¶ö‡ßç‡¶ö ‡¶ú‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡ßß</span><span id="th1" class="tide-val">‚Äî</span></div></div>
      <div class="tide-cell"><div class="tide-row"><span class="tide-label">‡¶â‡¶ö‡ßç‡¶ö ‡¶ú‡ßã‡¶Ø‡¶º‡¶æ‡¶∞ ‡ß®</span><span id="th2" class="tide-val">‚Äî</span></div></div>
      <div class="tide-cell"><div class="tide-row"><span class="tide-label">‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶≠‡¶æ‡¶ü‡¶æ ‡ßß</span><span id="tl1" class="tide-val">‚Äî</span></div></div>
      <div class="tide-cell"><div class="tide-row"><span class="tide-label">‡¶®‡¶ø‡¶Æ‡ßç‡¶® ‡¶≠‡¶æ‡¶ü‡¶æ ‡ß®</span><span id="tl2" class="tide-val">‚Äî</span></div></div>
    </div>
  </section>

<script>
(async function(){
  try{
    const base = location.origin.replace(/\/$/,'');
    const res = await fetch(base + '/api/panchika', { cache: 'no-store' });
    const d = await res.json();

    // Panchika
    set('tithi', d.tithi); set('nakshatra', d.nakshatra);
    set('sunrise', d.sunrise); set('sunset', d.sunset);
    set('moonrise', d.moonrise); set('moonset', d.moonset);

    // Ekadashi
    if (d.ekadashi){
      set('ekaName', d.ekadashi.name || '‚Äî');
      const meta = (d.ekadashi.date ? formatDate(d.ekadashi.date) : '‚Äî') +
                   (typeof d.ekadashi.days_left==='number' ? ` ‚Ä¢ ${d.ekadashi.days_left} ‡¶¶‡¶ø‡¶® ‡¶¨‡¶æ‡¶ï‡¶ø` : '');
      set('ekaMeta', meta);
    }

    // Festival (demo placeholder)
    const festDate = "2025-12-05";
    set('festMeta', `${formatDate(festDate)} ‚Ä¢ ${daysLeft(festDate)} ‡¶¶‡¶ø‡¶® ‡¶™‡¶∞‡ßá`);

    // Tide (placeholders)
    const T = (d.tide || []);
    set('th1', T[0]?.time || '‚Äî'); set('th2', T[1]?.time || '‚Äî');
    set('tl1', T[2]?.time || '‚Äî'); set('tl2', T[3]?.time || '‚Äî');
  }catch(e){ console.error(e); }

  // Popup trigger (placeholder hook)
  document.getElementById('calendarTrigger').addEventListener('click', () => {
    alert('Popup Calendar placeholder. Hook: madhabam-fullcalendar');
  });

  function set(id, v){ document.getElementById(id).textContent = v ?? '‚Äî'; }
  function daysLeft(dateStr){
    const now = new Date(); const d = new Date(dateStr+'T00:00:00');
    return Math.max(0, Math.ceil((d - now) / (1000*60*60*24)));
  }
  function formatDate(dateStr){
    // simple: YYYY-MM-DD -> DD MMM YYYY (bn digits not forced to avoid breaking)
    try{
      const d = new Date(dateStr+'T00:00:00');
      const opts = { day:'2-digit', month:'short', year:'numeric' };
      return new Intl.DateTimeFormat('bn-BD', opts).format(d);
    }catch{ return dateStr; }
  }
})();
</script>
</body>
</html>
